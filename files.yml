services:
  filebrowser:
      image: filebrowser/filebrowser:latest
      container_name: filebrowser
      ports:
        - "8081:80"
      volumes:
        - ${HOMEPATH}:/srv             # root of library
        - ${DOCKER}/filebrowser/data:/data   # File Browser user data
        - ${DOCKER}/filebrowser/config:/config
        - ${DOCKER}/filebrowser/db/filebrowser.db:/database/filebrowser.db
      restart: unless-stopped
      healthcheck:
        test: ["CMD-SHELL", "curl -s -f http://localhost:80/health | grep -q '\"status\":\"OK\"' || exit 1"]
        interval: 30s
        timeout: 5s
        retries: 3
        start_period: 10s
      env_file: stack.env
